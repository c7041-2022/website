<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>C7041 EDA - Lab 15 Model selection</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./img/c7041.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Lab 15 Model selection</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./img/c7041.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Information</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Home</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./schedule.html" class="sidebar-item-text sidebar-link">Schedule</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Part I</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab01-graph1.html" class="sidebar-item-text sidebar-link">Lab 01 Graphs I</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab02-descriptives.html" class="sidebar-item-text sidebar-link">Lab 02 Describing data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab03-frequency.html" class="sidebar-item-text sidebar-link">Lab 03 Frequency data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab04-contingency.html" class="sidebar-item-text sidebar-link">Lab 04 Contingency</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab05-Gaussian.html" class="sidebar-item-text sidebar-link">Lab 05 The Gaussian</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab06-2-groups.html" class="sidebar-item-text sidebar-link">Lab 06 Two-group tests</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab07-ANOVA.html" class="sidebar-item-text sidebar-link">Lab 07 ANOVA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab08-cor-reg.html" class="sidebar-item-text sidebar-link">Lab 08 Correlation and regression</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Part II</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab09-graph2.html" class="sidebar-item-text sidebar-link">Lab 09 Graphing II</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab10-sample-size.html" class="sidebar-item-text sidebar-link">Lab 10 Sample size</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab11-linear-mods.html" class="sidebar-item-text sidebar-link">Lab 11 Linear models</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab12-mixed-effects.html" class="sidebar-item-text sidebar-link">Lab 12 Mixed effects</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab13-likelihood.html" class="sidebar-item-text sidebar-link">Lab 13 Likelihood</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab14-GLM.html" class="sidebar-item-text sidebar-link">Lab 14 GLM</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab15-model-selection.html" class="sidebar-item-text sidebar-link active">Lab 15 Model selection</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#objectives" id="toc-objectives" class="nav-link active" data-scroll-target="#objectives">1 Objectives</a></li>
  <li><a href="#start-a-script" id="toc-start-a-script" class="nav-link" data-scroll-target="#start-a-script">2 Start a script!</a></li>
  <li><a href="#model-selection" id="toc-model-selection" class="nav-link" data-scroll-target="#model-selection">3 Model selection</a></li>
  <li><a href="#example-scaling-of-bmr-in-mammals" id="toc-example-scaling-of-bmr-in-mammals" class="nav-link" data-scroll-target="#example-scaling-of-bmr-in-mammals">4 Example: Scaling of BMR in mammals</a>
  <ul class="collapse">
  <li><a href="#suggested-solutions" id="toc-suggested-solutions" class="nav-link" data-scroll-target="#suggested-solutions">4.1 Suggested solutions</a></li>
  </ul></li>
  <li><a href="#example-bird-abundance-in-forest-fragments" id="toc-example-bird-abundance-in-forest-fragments" class="nav-link" data-scroll-target="#example-bird-abundance-in-forest-fragments">5 Example: Bird abundance in forest fragments</a>
  <ul class="collapse">
  <li><a href="#suggested-solutions-1" id="toc-suggested-solutions-1" class="nav-link" data-scroll-target="#suggested-solutions-1">5.1 Suggested solutions</a></li>
  </ul></li>
  <li><a href="#harper-adams-data-science" id="toc-harper-adams-data-science" class="nav-link" data-scroll-target="#harper-adams-data-science">Harper Adams Data Science</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Lab 15 Model selection</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><br></p>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/lab15-damsel.png" class="img-fluid figure-img" width="300"></p>
<p></p><figcaption class="figure-caption">Damselfly modelling</figcaption><p></p>
</figure>
</div>
</center>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">1 Objectives</h2>
<ul>
<li><p>Compare statistical models using real data</p></li>
<li><p>Evaluate statistical model fit</p></li>
<li><p>Use diagnostic information to rank and choose amongst statistical models</p></li>
</ul>
<p><br></p>
<p><a href="data/c7041-lab-data.zip">Data for all labs (unzip to your working directory)</a></p>
<p><a href="scripts/template_script.R">Template script</a></p>
<p><br></p>
</section>
<section id="start-a-script" class="level2">
<h2 class="anchored" data-anchor-id="start-a-script">2 Start a script!</h2>
<p>For this and every lab or project, begin by:</p>
<ul>
<li><p><strong>starting a new script</strong></p></li>
<li><p><strong>create a good header section and table of contents</strong></p></li>
<li><p><strong>save the script file with an informative name</strong></p></li>
<li><p><strong>set your working directory</strong></p></li>
</ul>
<p>Aim to make the script useful as a future reference for doing things in <code>R</code> - this will come in handy for projects and assessments!</p>
<p><br></p>
</section>
<section id="model-selection" class="level2">
<h2 class="anchored" data-anchor-id="model-selection">3 Model selection</h2>
<p>Selecting among candidate models requires a criterion for evaluating and comparing models, and a strategy for searching the possibilities. In this lab we will explore some of the tools available in R for model selection. You might need to download and install the <code>{MuMIn}</code> package from the CRAN website to carry out all the exercises.</p>
<p><br></p>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/lab15-zebra.png" class="img-fluid figure-img" width="300"></p>
<p></p><figcaption class="figure-caption">zebra</figcaption><p></p>
</figure>
</div>
</center>
</section>
<section id="example-scaling-of-bmr-in-mammals" class="level2">
<h2 class="anchored" data-anchor-id="example-scaling-of-bmr-in-mammals">4 Example: Scaling of BMR in mammals</h2>
<p>Savage et al.&nbsp;(2004, Functional Ecology 18: 257-282) used data to reevaluate competing claims for the value of the allometric scaling parameter <code>β</code> relating whole-organism Basal Metabolic Rate (BMR) rate to body mass in endotherms:</p>
<p><span class="math inline">\(BMR=\alpha M \beta\)</span></p>
<p><br></p>
<p>In this formula <code>BMR</code> is basal metabolic rate, <code>M</code> is body mass, and <code>α</code> is a constant. On a log scale this can be written as</p>
<p><span class="math inline">\(log(BMR)=log(\alpha)+\beta log(M)\)</span></p>
<p><br></p>
<p>where <code>β</code> is now a slope parameter of an ordinary linear regression – a linear model.</p>
<p>Theory based on optimization of hydrodynamic flows through the circulation system predicts that the exponent should be <code>β=3/4</code>, whereas we would expect <code>β=2/3</code> if metabolic rate scales with heat dissipation and therefore body surface area. These alternative scaling relationships represent distinct biophysical hypotheses. We will use them as candidate models and apply model selection procedures to compare their fits to data.</p>
<p><br></p>
<p>Savage et al.&nbsp;compiled data from 626 species of mammals. To simplify, and reduce possible effects of non-independence of species data points, they took the average of <code>log(BMR)</code> among species in small intervals of <code>log(M)</code>.</p>
<p>The resulting values of basal metabolic rate and mass can be found in the <code>mbr.csv</code> data file. Body mass is in grams, whereas basal metabolic rate is in watts.</p>
<p><br></p>
<ol type="1">
<li><p>Plot the data. Is the relationship between mass and metabolic rate linear on a log scale?</p></li>
<li><p>Fit a linear model to the log-transformed data (original data are not on the log scale). What is the estimate of slope?</p></li>
<li><p>Produce a 95% confidence interval for the slope. Does the interval include either of the candidate values for the scaling parameter β?</p></li>
<li><p>Add the least squares regression line from (2) to your plot.</p></li>
<li><p>Now let’s use model selection to compare the fits of the two candidate models to the data using the following steps.</p></li>
<li><p>To begin, you need to force regression lines having specified slopes through the (log-transformed) data. Replot the data indicating the relationship between log(M) and log(BMR). Add to this plot the best-fit line having slope 3/4. Repeat this for the slope 2/3. By eye, which line appears to fit the data best?</p></li>
<li><p>Compare the residual sum of squares of the two models you fit in (5). Which has the smaller value? Do these values agree with your visual assessment of your plots in (6)?</p></li>
<li><p>Calculate the log-likelihood of each model fitted in (5). Which has the higher value?</p></li>
<li><p>Calculate AIC for the two models, and the AIC difference*. By this criterion, which model is best? How big is the AIC difference?</p></li>
<li><p>In general terms, what does AIC score attempt to measure?</p></li>
<li><p>Calculate the Akaike weights of the two models**. Which has the higher weight of evidence in its favor? These weights would be used in Multimodel Inference (such as model averaging), which we won’t go into in this course. The weights should sum to 1. (They are sometimes interpreted as the posterior probability that the given model is the “best” model, assuming that the “best” model is one of the set of models being compared, but this interpretation makes assumptions that we won’t go into right now.)</p></li>
<li><p>Summarize the overall findings. Do both models have some support, according to standard criteria, or does one of the two models have essentially no support?</p></li>
<li><p>Why is it not possible to compare the two models using a conventional log-likelihood ratio test***?</p></li>
<li><p>Optional: Both theories mentioned earlier predict that the relationship between basal metabolic rate and body mass will conform to a power law — in other words that the relationship between <code>log(BMR)</code> and <code>log(M)</code> will be linear. Is the relationship linear in mammals? Use AIC to compare the fit of a linear model fitted to the relationship between <code>log(BMR)</code> and <code>log(M)</code> with the fit of a quadratic regression of <code>log(BMR)</code> on <code>log(M)</code> (a model in which both <code>log(M)</code> and <code>(log(M))2</code> are included as terms). Don’t force a slope of <code>2/3</code> or <code>3/4</code>. Plot both the linear and quadratic regression curves with the data. Which model has the most support? Which has the least? On the basis of this analysis, does the relationship between basal metabolic rate and body mass in mammals conform to a power law?</p></li>
</ol>
<p>* 23.73591</p>
<p>** 9.99e-01 7.01e-06</p>
<p>***The models are not nested.</p>
<p><br></p>
<section id="suggested-solutions" class="level3">
<h3 class="anchored" data-anchor-id="suggested-solutions">4.1 Suggested solutions</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(ggplot2))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(MuMIn))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(visreg))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(MASS))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(car))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Plot the data</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>bmr <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/bmr.csv"</span>, </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new variable right into the data object - I love this</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>bmr<span class="sc">$</span>logmass <span class="ot">&lt;-</span> <span class="fu">log</span>(bmr<span class="sc">$</span>mass.g)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>bmr<span class="sc">$</span>logbmr <span class="ot">&lt;-</span> <span class="fu">log</span>(bmr<span class="sc">$</span>bmr.w)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bmr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  mass.g bmr.w   logmass    logbmr
1    2.4 0.063 0.8754687 -2.764621
2    3.7 0.027 1.3083328 -3.611918
3    4.6 0.067 1.5260563 -2.703063
4    5.6 0.108 1.7227666 -2.225624
5    7.3 0.103 1.9878743 -2.273026
6    8.9 0.102 2.1860513 -2.282782</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(logbmr <span class="sc">~</span> logmass, <span class="at">data =</span> bmr, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">"Log body mass"</span>,   </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">"Log basal metabolic rate"</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">las =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">"blue"</span>) <span class="co"># mere vanity</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab15-model-selection_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Linear model</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">lm</span>(logbmr <span class="sc">~</span> logmass, <span class="at">data =</span> bmr)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = logbmr ~ logmass, data = bmr)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.18771 -0.13741  0.01169  0.17836  0.62592 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -4.00329    0.09858  -40.61   &lt;2e-16 ***
logmass      0.73654    0.01261   58.42   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3243 on 50 degrees of freedom
Multiple R-squared:  0.9856,    Adjusted R-squared:  0.9853 
F-statistic:  3413 on 1 and 50 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 2.5 %     97.5 %
(Intercept) -4.2013002 -3.8052825
logmass      0.7112222  0.7618661</code></pre>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Add the best-fit regression line to the plot in (1)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(logbmr <span class="sc">~</span> logmass, <span class="at">data =</span> bmr, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">"Log body mass"</span>,   </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">"Log basal metabolic rate"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">las =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">"blue"</span>) <span class="co"># mere vanity</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(z,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>) <span class="co"># mere vanity </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab15-model-selection_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Fit the two candidate models</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>z1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(logbmr <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">offset</span>( (<span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">*</span> logmass ), <span class="at">data =</span> bmr)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>z2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(logbmr <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">offset</span>( (<span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">*</span> logmass ), <span class="at">data =</span> bmr)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Replot</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(logbmr <span class="sc">~</span> logmass, <span class="at">data =</span> bmr, </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">las =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">"Log body mass"</span>, </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">"Log basal metabolic rate"</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># line for offset( (3/4) * logmass )</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="fu">coef</span>(z1), <span class="at">b =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co"># line for offset( (2/3) * logmass )</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="fu">coef</span>(z2), <span class="at">b =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab15-model-selection_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> bmr, <span class="fu">aes</span>(<span class="at">x =</span> logmass, <span class="at">y =</span> logbmr)) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">cex =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">coef</span>(z1), <span class="at">slope =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>, </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">coef</span>(z2), <span class="at">slope =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Log body mass"</span>, <span class="at">y =</span> <span class="st">"Log basal metabolic rate"</span>) <span class="sc">+</span> </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab15-model-selection_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. Compare the residual sum of squares</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(z1) <span class="co"># Notice model (Mean Sq) error</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: logbmr
          Df Sum Sq Mean Sq F value Pr(&gt;F)
Residuals 51 5.3777 0.10545               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(z2) <span class="co"># Notice more model (Mean Sq) error than z1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: logbmr
          Df Sum Sq Mean Sq F value Pr(&gt;F)
Residuals 51 8.4886 0.16644               </code></pre>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. Log-likelihoods</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># higher (better) log-likelihood for z1</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>( <span class="fu">logLik</span>(z1), <span class="fu">logLik</span>(z2) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -14.79135 -26.65930</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 9. AIC and AIC difference</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># lower (better) AIC for z1</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>( <span class="fu">AIC</span>(z1), <span class="fu">AIC</span>(z2) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 33.58269 57.31860</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>delta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">AIC</span>(z1), <span class="fu">AIC</span>(z2)) <span class="sc">-</span> <span class="fu">min</span>(<span class="fu">AIC</span>(z1), <span class="fu">AIC</span>(z2))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>delta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.00000 23.73591</code></pre>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 11. Akaike weights of the two models</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> delta)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>L<span class="sc">/</span><span class="fu">sum</span>(L)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.999930e-01 7.011488e-06</code></pre>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 14. Compare the fit of linear and quadratic models</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>zlin <span class="ot">&lt;-</span> <span class="fu">lm</span>(logbmr <span class="sc">~</span> logmass, <span class="at">data =</span> bmr)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>zquad <span class="ot">&lt;-</span> <span class="fu">lm</span>(logbmr <span class="sc">~</span> logmass <span class="sc">+</span> <span class="fu">I</span>(logmass<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> bmr)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Get predicted values from each model</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>bmr<span class="sc">$</span>predictLin <span class="ot">&lt;-</span> <span class="fu">predict</span>(zlin)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>bmr<span class="sc">$</span>predictQuad <span class="ot">&lt;-</span> <span class="fu">predict</span>(zquad)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(logbmr <span class="sc">~</span> logmass, <span class="at">data =</span> bmr, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">"Log body mass"</span>, <span class="at">ylab =</span> <span class="st">"Log basal metabolic rate"</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(predictLin <span class="sc">~</span> logmass, <span class="at">data =</span> bmr,</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="co"># vanity</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(predictQuad <span class="sc">~</span> logmass, <span class="at">data =</span> bmr,</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="co"># vanity</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab15-model-selection_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">AIC</span>(zlin), <span class="fu">AIC</span>(zquad))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 34.41123 21.58976</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">AIC</span>(zlin), <span class="fu">AIC</span>(zquad)) <span class="sc">-</span> <span class="fu">min</span>(<span class="fu">c</span>(<span class="fu">AIC</span>(zlin), <span class="fu">AIC</span>(zquad)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.82146  0.00000</code></pre>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="example-bird-abundance-in-forest-fragments" class="level2">
<h2 class="anchored" data-anchor-id="example-bird-abundance-in-forest-fragments">5 Example: Bird abundance in forest fragments</h2>
<p><br></p>
<p>In this example we are going “data dredging” (looking at many competing models without a specific hypothesis), with all its attendant risks, unlike the previous example (where we had very specific, biologically motivated hypotheses). Here, we have no candidate models. Let’s just try all possibilities and see what turns up. The data include a set of possible explanatory variables and we want to known which model, of all possible models, is the “best”. Sensibly, we also wish to identify those models that are near-best and should be kept under consideration (e.g., for use in planning, or subsequent multimodel inference).</p>
<p>The response variable is the abundance of forest birds in 56 forest fragment in southeastern Australia by Loyn (1987, cited in Quinn and Keough [2002] and analyzed in their Box 6.2). Abundance is measured as the number of birds encountered in a timed survey (units aren’t explained). Six predictor variables were measured in each fragment:</p>
<ul>
<li><p>area: fragment area (ha)</p></li>
<li><p>dist: distance to the nearest other fragment (km)</p></li>
<li><p>ldist: distance to the nearest larger fragment (km)</p></li>
<li><p>graze: grazing pressure (1 to 5, indicating light to heavy)</p></li>
<li><p>alt: altitude (m)</p></li>
<li><p>yr.isol: number of years since fragmentation.</p></li>
</ul>
<p>The data are in the file <code>birdabund.csv</code>.</p>
<p><br></p>
<ol type="1">
<li><p>Using histograms, scatter plots, or the pairs command, explore the frequency distributions of the variables. Several of the variables are highly skewed, which will lead to outliers having excessive leverage. Transform the highly skewed variables to solve this problem. (I log-transformed area, dist and ldist. The results are not perfect.)</p></li>
<li><p>Use the cor command to estimate the correlation between pairs of explanatory variables. The results will be easier to read if you round to just a couple of decimals. Which are the most highly correlated variables?</p></li>
<li><p>Using the model selection tool dredge() in the MuMIn package, determine which linear model best predicts bird abundance (use AIC as the criterion). dredge() carries out an automated model search using subsets of the ‘global’ model provided. Ignore interactions for this exercise. (You will need to install the MuMIn package if you haven’t yet done so.)</p></li>
<li><p>How many variables are included in the best model*?</p></li>
<li><p>Count the number of models in total having an AIC difference less than or equal to 7. This is one way to decide which models have some support and remain under consideration.</p></li>
<li><p>Another way to determine the set of models that have support is to use AIC weights. Calculate the Akaike weights of all the models from your dredge() analysis. How much weight is given to the best model**? Are there common features shared among the models having the highest weights?</p></li>
<li><p>How many models are in the “confidence set” whose cumulative weights reach 0.95***?</p></li>
<li><p>Use a linear model to fit the “best” model to the data. Produce a summary of the results. Use <code>visreg()</code> to visualize the conditional relationship between bird abundance and each of the three variables in the “best” model one at a time. Visually, which variable seems to have the strongest relationship with bird abundance in the model?</p></li>
<li><p>Generate an ANOVA table for the best model. Use Type 2 or Type 3 sums of squares so that the order of entry of the main effects in the formula don’t affect the tests (there are no interactions). Why should we view the resulting P-values with a great deal of skepticism****?</p></li>
<li><p>Notice that in your ANOVA table, not all terms in the best model are stastically significant at P&lt;0.05 and so would not be retained in a stepwise multiple regression process. Are you OK with this? Good.</p></li>
</ol>
<p>* 3 plus intercept (plus variance of residuals makes “df” = 5 parameters estimated)</p>
<p>** 0.127</p>
<p>*** 20</p>
<p>**** Because we arrived at this model by data dredging.</p>
<p><br></p>
<p>Let’s try analyzing the data using <code>stepAIC()</code> from the <code>{MASS}</code> package. Despite its name the method is not carrying out stepwise multiple regression. Rather, it is using a stepwise search strategy (hopefully) to find the “best” model (the model minimizing the AIC score) given certain restrictions. Restrictions include higher order terms (e.g., interaction between two variables) not being fitted without including corresponding lower order terms (e.g., main effects of those same variables). Unlike <code>dredge()</code> it does not test all (restricted) subsets of the global model and so does not provide a list of all other models that fit the data nearly equally well as the “best” model. But it can be much faster if there are many variables.</p>
<p><br></p>
<ol start="11" type="1">
<li><p>Return to the data set you just analyzed using <code>dredge()</code> and run model selection using <code>stepAIC()</code> instead. Did you arrive at the same best model?</p></li>
<li><p>Run <code>stepAIC()</code> again, but this time use a model that includes all two-way interaction terms. This is already pushing the data to the limit, because there are only 56 data points. View the printed output on the screen to see the sequence of steps that stepAIC takes to find the best model.</p></li>
<li><p>Estimate the coefficients of the best-fitting model.</p></li>
<li><p>Calculate AIC for the best model. How does it compare to the AIC value computed in previously for the best additive model (the best model without interaction terms)?** Does the additive model have “essentially no support”, as defined in lecture**?</p></li>
</ol>
<p>* 360.7 vs 371.1</p>
<p>** Yes, because the AIC difference is large, exceeding 10.</p>
<p><br></p>
<section id="suggested-solutions-1" class="level3">
<h3 class="anchored" data-anchor-id="suggested-solutions-1">5.1 Suggested solutions</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Read, plot and transform </span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>birds <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/birdabund.csv"</span>, </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(birds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  abund area yr.isol dist ldist graze alt
1   5.3  0.1    1968   39    39     2 160
2   2.0  0.5    1920  234   234     5  60
3   1.5  0.5    1900  104   311     5 140
4  17.1  1.0    1966   66    66     3 160
5  13.8  1.0    1918  246   246     5 140
6  14.1  1.0    1965  234   285     3 130</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(birds, <span class="at">gap =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab15-model-selection_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Notice variables: area, dist, and ldist have wide scale</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Try log-transforming area, dist, and ldist . </span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The results are better but not perfect)</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>birds2 <span class="ot">&lt;-</span> birds[, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">7</span>)]</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>birds2<span class="sc">$</span>logarea <span class="ot">&lt;-</span> <span class="fu">log</span>(birds<span class="sc">$</span>area)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>birds2<span class="sc">$</span>logdist <span class="ot">&lt;-</span> <span class="fu">log</span>(birds<span class="sc">$</span>dist)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>birds2<span class="sc">$</span>logldist <span class="ot">&lt;-</span> <span class="fu">log</span>(birds<span class="sc">$</span>ldist)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(birds2, <span class="at">gap =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab15-model-selection_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Correlation between explanatory variables</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">cor</span>(birds2)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(z, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         abund yr.isol graze   alt logarea logdist logldist
abund     1.00    0.50 -0.68  0.39    0.74    0.13     0.12
yr.isol   0.50    1.00 -0.64  0.23    0.28   -0.02    -0.16
graze    -0.68   -0.64  1.00 -0.41   -0.56   -0.14    -0.03
alt       0.39    0.23 -0.41  1.00    0.28   -0.22    -0.27
logarea   0.74    0.28 -0.56  0.28    1.00    0.30     0.38
logdist   0.13   -0.02 -0.14 -0.22    0.30    1.00     0.60
logldist  0.12   -0.16 -0.03 -0.27    0.38    0.60     1.00</code></pre>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Best linear model</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">na.action =</span> <span class="st">"na.fail"</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>birds.fullmodel <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> abund <span class="sc">~</span> ., <span class="co"># The "~ ." is shorthand for all other vars</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> birds2)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>birds.dredge <span class="ot">&lt;-</span> <span class="fu">dredge</span>(birds.fullmodel, <span class="at">rank =</span> <span class="st">"AIC"</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(birds.dredge, <span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Global model call: lm(formula = abund ~ ., data = birds2)
---
Model selection table 
      (Int)     alt    grz   lgr     lgd     lgl  yr.isl df   logLik   AIC
39 -134.300         -1.902 3.112                 0.07835  5 -180.555 371.1
40 -141.900 0.02586 -1.601 3.073                 0.07991  6 -179.761 371.5
55 -113.400         -1.842 3.366         -0.7149 0.06941  6 -180.036 372.1
47 -120.500         -1.939 3.251 -0.8894         0.07354  6 -180.072 372.1
7    21.600         -2.854 2.992                          4 -182.257 372.5
23   25.740         -2.630 3.348         -0.9511          5 -181.347 372.7
38 -236.700 0.03623        3.540                 0.12480  5 -181.428 372.9
8    17.280 0.02468 -2.584 2.953                          5 -181.577 373.2
15   26.630         -2.827 3.169 -1.0750                  5 -181.582 373.2
48 -131.800 0.02145 -1.676 3.168 -0.5660         0.07658  7 -179.585 373.2
56 -127.700 0.02081 -1.624 3.234         -0.4331 0.07419  7 -179.597 373.2
63 -111.800         -1.884 3.368 -0.5458 -0.4805 0.06939  7 -179.908 373.8
37 -252.200                3.732                 0.13520  4 -182.993 374.0
24   22.020 0.01615 -2.502 3.245         -0.7451          6 -181.093 374.2
31   27.280         -2.671 3.350 -0.5475 -0.7159          6 -181.225 374.5
16   22.110 0.01850 -2.632 3.095 -0.8027                  6 -181.238 374.5
54 -225.800 0.03206        3.682         -0.3684 0.12050  6 -181.316 374.6
53 -223.900                4.001         -0.8221 0.12290  5 -182.360 374.7
46 -233.700 0.03413        3.602 -0.3024         0.12420  6 -181.380 374.8
64 -125.700 0.01951 -1.668 3.244 -0.3939 -0.2816 0.07387  8 -179.532 375.1
45 -241.900                3.867 -0.7971         0.13190  5 -182.638 375.3
32   23.560 0.01474 -2.546 3.256 -0.4328 -0.5771          7 -181.018 376.0
62 -226.000 0.03180        3.688 -0.1033 -0.3281 0.12070  7 -181.312 376.6
61 -224.400                4.011 -0.3060 -0.6920 0.12360  6 -182.322 376.6
6     3.959 0.04862        3.935                          4 -187.342 382.7
   delta weight
39  0.00  0.127
40  0.41  0.103
55  0.96  0.078
47  1.04  0.076
7   1.40  0.063
23  1.59  0.057
38  1.75  0.053
8   2.05  0.046
15  2.06  0.045
48  2.06  0.045
56  2.09  0.045
63  2.71  0.033
37  2.88  0.030
24  3.08  0.027
31  3.34  0.024
16  3.37  0.024
54  3.52  0.022
53  3.61  0.021
46  3.65  0.020
64  3.95  0.018
45  4.17  0.016
32  4.93  0.011
62  5.51  0.008
61  5.54  0.008
6  11.57  0.000
Models ranked by AIC(x) </code></pre>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Models with delta AIC &lt; 7</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(birds.dredge[birds.dredge<span class="sc">$</span>delta <span class="sc">&lt;</span> <span class="dv">7</span>, ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Akaike weights</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">Weights</span>(birds.dredge)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>w</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>AIC model weights 
   39    40    55    47     7    23    38     8    15    48    56    63    37 
0.127 0.103 0.078 0.076 0.063 0.057 0.053 0.046 0.045 0.045 0.045 0.033 0.030 
   24    31    16    54    53    46    64    45    32    62    61     6    22 
0.027 0.024 0.024 0.022 0.021 0.020 0.018 0.016 0.011 0.008 0.008 0.000 0.000 
   21    14    30    29     5    13     3    52    20     4    19    35    36 
0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
   51    11    12    60    28    44    27    43    59    50    58    42    34 
0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
   49    33    41    57    18    10    26     2     1     9    17    25 
0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. Models in the 95% "confidence set"</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">cumsum</span>(w)[<span class="fu">cumsum</span>(w)<span class="sc">&lt;</span> <span class="fl">0.95</span>]) <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. Refit best linear model</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>bestmodel <span class="ot">&lt;-</span> <span class="fu">get.models</span>(birds.dredge, <span class="dv">1</span>)[[<span class="dv">1</span>]]</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">lm</span>(bestmodel, <span class="at">data =</span> birds2)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bestmodel, data = birds2)

Residuals:
     Min       1Q   Median       3Q      Max 
-14.5159  -3.8136   0.2027   3.1271  14.5542 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -134.26065   86.39085  -1.554   0.1262    
graze         -1.90216    0.87447  -2.175   0.0342 *  
logarea        3.11223    0.55268   5.631 7.32e-07 ***
yr.isol        0.07835    0.04340   1.805   0.0768 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.311 on 52 degrees of freedom
Multiple R-squared:  0.6732,    Adjusted R-squared:  0.6544 
F-statistic: 35.71 on 3 and 52 DF,  p-value: 1.135e-12</code></pre>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Based on our data dredging, the best model has 3 variables:</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co"># graze, logarea, and yr.isol</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the dependent var against each of these</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(z, <span class="at">xvar =</span> <span class="st">"graze"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab15-model-selection_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(z, <span class="at">xvar =</span> <span class="st">"logarea"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab15-model-selection_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(z, <span class="at">xvar =</span> <span class="st">"yr.isol"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab15-model-selection_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 9. ANOVA</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(z, <span class="at">type =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: abund
             Sum Sq Df F value    Pr(&gt;F)    
(Intercept)   96.20  1  2.4152   0.12622    
graze        188.45  1  4.7315   0.03418 *  
logarea     1262.97  1 31.7094 7.316e-07 ***
yr.isol      129.81  1  3.2590   0.07682 .  
Residuals   2071.14 52                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">lm</span>(abund <span class="sc">~</span> ., <span class="at">data =</span> birds2)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>z1 <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(z, <span class="at">direction =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=214.14
abund ~ yr.isol + graze + alt + logarea + logdist + logldist

           Df Sum of Sq    RSS    AIC
- logldist  1      3.80 2000.7 212.25
- logdist   1      4.68 2001.5 212.27
- alt       1     27.02 2023.9 212.90
&lt;none&gt;                  1996.8 214.14
- yr.isol   1    108.83 2105.7 215.11
- graze     1    131.07 2127.9 215.70
- logarea   1   1059.75 3056.6 235.98

Step:  AIC=212.25
abund ~ yr.isol + graze + alt + logarea + logdist

           Df Sum of Sq    RSS    AIC
- logdist   1     12.64 2013.3 210.60
- alt       1     35.12 2035.8 211.22
&lt;none&gt;                  2000.7 212.25
- yr.isol   1    121.64 2122.3 213.55
- graze     1    132.44 2133.1 213.84
+ logldist  1      3.80 1996.9 214.14
- logarea   1   1193.04 3193.7 236.44

Step:  AIC=210.6
abund ~ yr.isol + graze + alt + logarea

           Df Sum of Sq    RSS    AIC
- alt       1     57.84 2071.1 210.19
&lt;none&gt;                  2013.3 210.60
- graze     1    123.48 2136.8 211.94
- yr.isol   1    134.89 2148.2 212.23
+ logdist   1     12.64 2000.7 212.25
+ logldist  1     11.76 2001.5 212.27
- logarea   1   1227.11 3240.4 235.25

Step:  AIC=210.19
abund ~ yr.isol + graze + logarea

           Df Sum of Sq    RSS    AIC
&lt;none&gt;                  2071.1 210.19
+ alt       1     57.84 2013.3 210.60
+ logldist  1     38.04 2033.1 211.15
+ logdist   1     35.36 2035.8 211.22
- yr.isol   1    129.81 2200.9 211.59
- graze     1    188.45 2259.6 213.06
- logarea   1   1262.97 3334.1 234.85</code></pre>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 11. Model selection using stepAIC()</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">lm</span>(abund <span class="sc">~</span> ., <span class="at">data =</span> birds2)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>z1 <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(z, <span class="at">direction =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=214.14
abund ~ yr.isol + graze + alt + logarea + logdist + logldist

           Df Sum of Sq    RSS    AIC
- logldist  1      3.80 2000.7 212.25
- logdist   1      4.68 2001.5 212.27
- alt       1     27.02 2023.9 212.90
&lt;none&gt;                  1996.8 214.14
- yr.isol   1    108.83 2105.7 215.11
- graze     1    131.07 2127.9 215.70
- logarea   1   1059.75 3056.6 235.98

Step:  AIC=212.25
abund ~ yr.isol + graze + alt + logarea + logdist

           Df Sum of Sq    RSS    AIC
- logdist   1     12.64 2013.3 210.60
- alt       1     35.12 2035.8 211.22
&lt;none&gt;                  2000.7 212.25
- yr.isol   1    121.64 2122.3 213.55
- graze     1    132.44 2133.1 213.84
+ logldist  1      3.80 1996.9 214.14
- logarea   1   1193.04 3193.7 236.44

Step:  AIC=210.6
abund ~ yr.isol + graze + alt + logarea

           Df Sum of Sq    RSS    AIC
- alt       1     57.84 2071.1 210.19
&lt;none&gt;                  2013.3 210.60
- graze     1    123.48 2136.8 211.94
- yr.isol   1    134.89 2148.2 212.23
+ logdist   1     12.64 2000.7 212.25
+ logldist  1     11.76 2001.5 212.27
- logarea   1   1227.11 3240.4 235.25

Step:  AIC=210.19
abund ~ yr.isol + graze + logarea

           Df Sum of Sq    RSS    AIC
&lt;none&gt;                  2071.1 210.19
+ alt       1     57.84 2013.3 210.60
+ logldist  1     38.04 2033.1 211.15
+ logdist   1     35.36 2035.8 211.22
- yr.isol   1    129.81 2200.9 211.59
- graze     1    188.45 2259.6 213.06
- logarea   1   1262.97 3334.1 234.85</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>z1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = abund ~ yr.isol + graze + logarea, data = birds2)

Coefficients:
(Intercept)      yr.isol        graze      logarea  
 -134.26065      0.07835     -1.90216      3.11223  </code></pre>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 12. Include all two-way interactions</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">lm</span>(abund <span class="sc">~</span> (.)<span class="sc">^</span><span class="dv">2</span>, <span class="at">data =</span> birds2)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>z2 <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(z, <span class="at">upper =</span> <span class="sc">~</span>., <span class="at">lower =</span> <span class="sc">~</span><span class="dv">1</span>, <span class="at">direction =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=222.63
abund ~ (yr.isol + graze + alt + logarea + logdist + logldist)^2

                   Df Sum of Sq    RSS    AIC
- graze:logdist     1     0.003 1360.0 220.63
- yr.isol:logldist  1     0.026 1360.0 220.63
- alt:logdist       1     0.058 1360.1 220.64
- logdist:logldist  1     0.572 1360.6 220.66
- graze:alt         1     3.100 1363.1 220.76
- graze:logldist    1     5.262 1365.3 220.85
- yr.isol:logdist   1    11.826 1371.8 221.12
- logarea:logdist   1    12.196 1372.2 221.13
- logarea:logldist  1    20.330 1380.3 221.47
- alt:logldist      1    20.369 1380.4 221.47
- alt:logarea       1    24.223 1384.2 221.62
- graze:logarea     1    26.546 1386.6 221.72
- yr.isol:alt       1    26.559 1386.6 221.72
- yr.isol:logarea   1    36.513 1396.5 222.12
&lt;none&gt;                          1360.0 222.63
- yr.isol:graze     1   161.328 1521.3 226.91

Step:  AIC=220.63
abund ~ yr.isol + graze + alt + logarea + logdist + logldist + 
    yr.isol:graze + yr.isol:alt + yr.isol:logarea + yr.isol:logdist + 
    yr.isol:logldist + graze:alt + graze:logarea + graze:logldist + 
    alt:logarea + alt:logdist + alt:logldist + logarea:logdist + 
    logarea:logldist + logdist:logldist

                   Df Sum of Sq    RSS    AIC
- yr.isol:logldist  1     0.045 1360.1 218.64
- alt:logdist       1     0.055 1360.1 218.64
- logdist:logldist  1     0.569 1360.6 218.66
- graze:alt         1     3.213 1363.2 218.77
- graze:logldist    1     9.220 1369.2 219.01
- logarea:logdist   1    13.672 1373.7 219.19
- alt:logldist      1    20.599 1380.6 219.48
- logarea:logldist  1    23.052 1383.1 219.58
- yr.isol:logdist   1    27.360 1387.4 219.75
- yr.isol:alt       1    27.398 1387.4 219.75
- graze:logarea     1    27.640 1387.7 219.76
- alt:logarea       1    29.525 1389.5 219.84
- yr.isol:logarea   1    37.337 1397.3 220.15
&lt;none&gt;                          1360.0 220.63
+ graze:logdist     1     0.003 1360.0 222.63
- yr.isol:graze     1   194.657 1554.7 226.12

Step:  AIC=218.64
abund ~ yr.isol + graze + alt + logarea + logdist + logldist + 
    yr.isol:graze + yr.isol:alt + yr.isol:logarea + yr.isol:logdist + 
    graze:alt + graze:logarea + graze:logldist + alt:logarea + 
    alt:logdist + alt:logldist + logarea:logdist + logarea:logldist + 
    logdist:logldist

                   Df Sum of Sq    RSS    AIC
- alt:logdist       1     0.052 1360.1 216.64
- logdist:logldist  1     0.527 1360.6 216.66
- graze:alt         1     3.169 1363.2 216.77
- graze:logldist    1    14.092 1374.2 217.21
- logarea:logdist   1    15.428 1375.5 217.27
- alt:logldist      1    20.608 1380.7 217.48
- logarea:logldist  1    27.209 1387.3 217.75
- yr.isol:logdist   1    29.616 1389.7 217.84
- yr.isol:alt       1    31.735 1391.8 217.93
- graze:logarea     1    31.869 1391.9 217.93
- alt:logarea       1    32.099 1392.2 217.94
- yr.isol:logarea   1    43.797 1403.9 218.41
&lt;none&gt;                          1360.1 218.64
+ yr.isol:logldist  1     0.045 1360.0 220.63
+ graze:logdist     1     0.023 1360.0 220.63
- yr.isol:graze     1   194.784 1554.8 224.13

Step:  AIC=216.64
abund ~ yr.isol + graze + alt + logarea + logdist + logldist + 
    yr.isol:graze + yr.isol:alt + yr.isol:logarea + yr.isol:logdist + 
    graze:alt + graze:logarea + graze:logldist + alt:logarea + 
    alt:logldist + logarea:logdist + logarea:logldist + logdist:logldist

                   Df Sum of Sq    RSS    AIC
- logdist:logldist  1     0.667 1360.8 214.67
- graze:alt         1     3.471 1363.6 214.78
- graze:logldist    1    14.281 1374.4 215.22
- logarea:logdist   1    16.073 1376.2 215.30
- logarea:logldist  1    29.605 1389.7 215.84
- alt:logarea       1    32.129 1392.2 215.95
- yr.isol:alt       1    33.316 1393.4 215.99
- yr.isol:logdist   1    34.003 1394.1 216.02
- graze:logarea     1    34.969 1395.1 216.06
- alt:logldist      1    40.951 1401.1 216.30
&lt;none&gt;                          1360.1 216.64
- yr.isol:logarea   1    54.393 1414.5 216.83
+ alt:logdist       1     0.052 1360.1 218.64
+ yr.isol:logldist  1     0.042 1360.1 218.64
+ graze:logdist     1     0.011 1360.1 218.64
- yr.isol:graze     1   222.578 1582.7 223.13

Step:  AIC=214.67
abund ~ yr.isol + graze + alt + logarea + logdist + logldist + 
    yr.isol:graze + yr.isol:alt + yr.isol:logarea + yr.isol:logdist + 
    graze:alt + graze:logarea + graze:logldist + alt:logarea + 
    alt:logldist + logarea:logdist + logarea:logldist

                   Df Sum of Sq    RSS    AIC
- graze:alt         1     2.898 1363.7 212.78
- graze:logldist    1    18.727 1379.5 213.43
- logarea:logdist   1    23.605 1384.4 213.63
- logarea:logldist  1    30.094 1390.9 213.89
- yr.isol:alt       1    33.061 1393.8 214.01
- alt:logarea       1    34.491 1395.3 214.07
- graze:logarea     1    38.287 1399.1 214.22
- alt:logldist      1    41.609 1402.4 214.35
- yr.isol:logdist   1    41.909 1402.7 214.37
&lt;none&gt;                          1360.8 214.67
- yr.isol:logarea   1    57.207 1418.0 214.97
+ logdist:logldist  1     0.667 1360.1 216.64
+ alt:logdist       1     0.192 1360.6 216.66
+ graze:logdist     1     0.008 1360.8 216.67
+ yr.isol:logldist  1     0.000 1360.8 216.67
- yr.isol:graze     1   223.303 1584.1 221.18

Step:  AIC=212.79
abund ~ yr.isol + graze + alt + logarea + logdist + logldist + 
    yr.isol:graze + yr.isol:alt + yr.isol:logarea + yr.isol:logdist + 
    graze:logarea + graze:logldist + alt:logarea + alt:logldist + 
    logarea:logdist + logarea:logldist

                   Df Sum of Sq    RSS    AIC
- logarea:logdist   1    25.007 1388.7 211.80
- graze:logldist    1    28.377 1392.1 211.94
- logarea:logldist  1    32.029 1395.7 212.09
- yr.isol:alt       1    33.892 1397.6 212.16
- alt:logldist      1    38.726 1402.4 212.35
- alt:logarea       1    45.754 1409.4 212.63
- yr.isol:logdist   1    46.139 1409.8 212.65
- graze:logarea     1    49.541 1413.2 212.78
&lt;none&gt;                          1363.7 212.78
- yr.isol:logarea   1    74.795 1438.5 213.78
+ graze:alt         1     2.898 1360.8 214.67
+ alt:logdist       1     0.419 1363.3 214.77
+ graze:logdist     1     0.238 1363.4 214.78
+ logdist:logldist  1     0.095 1363.6 214.78
+ yr.isol:logldist  1     0.017 1363.7 214.78
- yr.isol:graze     1   222.021 1585.7 219.23

Step:  AIC=211.8
abund ~ yr.isol + graze + alt + logarea + logdist + logldist + 
    yr.isol:graze + yr.isol:alt + yr.isol:logarea + yr.isol:logdist + 
    graze:logarea + graze:logldist + alt:logarea + alt:logldist + 
    logarea:logldist

                   Df Sum of Sq    RSS    AIC
- logarea:logldist  1     7.647 1396.3 210.11
- graze:logldist    1    13.313 1402.0 210.34
- yr.isol:logdist   1    23.990 1412.7 210.76
- yr.isol:alt       1    29.485 1418.2 210.98
- alt:logldist      1    32.060 1420.8 211.08
- alt:logarea       1    37.527 1426.2 211.30
- graze:logarea     1    46.646 1435.3 211.65
&lt;none&gt;                          1388.7 211.80
- yr.isol:logarea   1    67.711 1456.4 212.47
+ logarea:logdist   1    25.007 1363.7 212.78
+ graze:logdist     1    11.313 1377.4 213.34
+ yr.isol:logldist  1     6.990 1381.7 213.52
+ logdist:logldist  1     5.412 1383.3 213.58
+ graze:alt         1     4.301 1384.4 213.63
+ alt:logdist       1     4.282 1384.4 213.63
- yr.isol:graze     1   212.098 1600.8 217.76

Step:  AIC=210.11
abund ~ yr.isol + graze + alt + logarea + logdist + logldist + 
    yr.isol:graze + yr.isol:alt + yr.isol:logarea + yr.isol:logdist + 
    graze:logarea + graze:logldist + alt:logarea + alt:logldist

                   Df Sum of Sq    RSS    AIC
- graze:logldist    1     8.526 1404.9 208.45
- yr.isol:logdist   1    20.997 1417.3 208.95
- yr.isol:alt       1    28.937 1425.3 209.26
- alt:logldist      1    30.792 1427.1 209.33
- alt:logarea       1    32.128 1428.5 209.38
&lt;none&gt;                          1396.3 210.11
- graze:logarea     1    57.851 1454.2 210.38
+ graze:logdist     1    12.848 1383.5 211.59
+ yr.isol:logldist  1     7.749 1388.6 211.80
+ logarea:logldist  1     7.647 1388.7 211.80
+ graze:alt         1     4.856 1391.5 211.91
+ alt:logdist       1     4.769 1391.6 211.92
- yr.isol:logarea   1   100.005 1496.3 211.98
+ logdist:logldist  1     0.651 1395.7 212.08
+ logarea:logdist   1     0.626 1395.7 212.09
- yr.isol:graze     1   244.977 1641.3 217.16

Step:  AIC=208.45
abund ~ yr.isol + graze + alt + logarea + logdist + logldist + 
    yr.isol:graze + yr.isol:alt + yr.isol:logarea + yr.isol:logdist + 
    graze:logarea + alt:logarea + alt:logldist

                   Df Sum of Sq    RSS    AIC
- yr.isol:logdist   1    20.776 1425.6 207.27
- yr.isol:alt       1    25.024 1429.9 207.44
- alt:logldist      1    39.643 1444.5 208.01
- graze:logarea     1    49.331 1454.2 208.38
&lt;none&gt;                          1404.9 208.45
- alt:logarea       1    53.564 1458.4 208.55
+ graze:logdist     1    19.974 1384.9 209.65
+ graze:alt         1     9.823 1395.0 210.06
+ graze:logldist    1     8.526 1396.3 210.11
+ logarea:logldist  1     2.860 1402.0 210.34
+ alt:logdist       1     2.383 1402.5 210.36
+ logdist:logldist  1     2.145 1402.7 210.37
+ logarea:logdist   1     0.610 1404.2 210.43
+ yr.isol:logldist  1     0.046 1404.8 210.45
- yr.isol:logarea   1   116.372 1521.2 210.91
- yr.isol:graze     1   260.447 1665.3 215.97

Step:  AIC=207.27
abund ~ yr.isol + graze + alt + logarea + logdist + logldist + 
    yr.isol:graze + yr.isol:alt + yr.isol:logarea + graze:logarea + 
    alt:logarea + alt:logldist

                   Df Sum of Sq    RSS    AIC
- logdist           1     8.091 1433.7 205.59
- alt:logldist      1    38.442 1464.1 206.76
- graze:logarea     1    44.691 1470.3 207.00
- alt:logarea       1    50.969 1476.6 207.24
&lt;none&gt;                          1425.6 207.27
- yr.isol:alt       1    54.739 1480.4 207.38
+ yr.isol:logdist   1    20.776 1404.9 208.45
+ graze:alt         1    13.009 1412.6 208.76
+ graze:logldist    1     8.305 1417.3 208.95
- yr.isol:logarea   1    98.416 1524.0 209.01
+ logdist:logldist  1     3.953 1421.7 209.12
+ logarea:logldist  1     1.296 1424.3 209.22
+ alt:logdist       1     0.689 1425.0 209.25
+ yr.isol:logldist  1     0.535 1425.1 209.25
+ graze:logdist     1     0.225 1425.4 209.26
+ logarea:logdist   1     0.187 1425.5 209.27
- yr.isol:graze     1   253.153 1678.8 214.43

Step:  AIC=205.59
abund ~ yr.isol + graze + alt + logarea + logldist + yr.isol:graze + 
    yr.isol:alt + yr.isol:logarea + graze:logarea + alt:logarea + 
    alt:logldist

                   Df Sum of Sq    RSS    AIC
- alt:logldist      1    38.160 1471.9 205.06
- graze:logarea     1    42.558 1476.3 205.23
- alt:logarea       1    47.587 1481.3 205.42
&lt;none&gt;                          1433.7 205.59
- yr.isol:alt       1    53.683 1487.4 205.65
+ graze:logldist    1    11.379 1422.3 207.14
+ graze:alt         1    10.881 1422.8 207.16
- yr.isol:logarea   1    95.540 1529.3 207.20
+ logdist           1     8.091 1425.6 207.27
+ logarea:logldist  1     2.582 1431.2 207.49
+ yr.isol:logldist  1     0.039 1433.7 207.59
- yr.isol:graze     1   247.203 1680.9 212.50

Step:  AIC=205.06
abund ~ yr.isol + graze + alt + logarea + logldist + yr.isol:graze + 
    yr.isol:alt + yr.isol:logarea + graze:logarea + alt:logarea

                   Df Sum of Sq    RSS    AIC
- logldist          1     4.777 1476.7 203.24
- alt:logarea       1    21.891 1493.8 203.89
- yr.isol:alt       1    32.877 1504.8 204.30
&lt;none&gt;                          1471.9 205.06
+ alt:logldist      1    38.160 1433.7 205.59
- graze:logarea     1    73.770 1545.7 205.80
+ graze:logldist    1    20.795 1451.1 206.26
+ logdist           1     7.810 1464.1 206.76
+ graze:alt         1     3.830 1468.1 206.91
+ yr.isol:logldist  1     2.381 1469.5 206.97
+ logarea:logldist  1     0.897 1471.0 207.03
- yr.isol:logarea   1   173.397 1645.3 209.30
- yr.isol:graze     1   242.803 1714.7 211.61

Step:  AIC=203.24
abund ~ yr.isol + graze + alt + logarea + yr.isol:graze + yr.isol:alt + 
    yr.isol:logarea + graze:logarea + alt:logarea

                  Df Sum of Sq    RSS    AIC
- alt:logarea      1    18.904 1495.6 201.96
- yr.isol:alt      1    28.886 1505.5 202.33
&lt;none&gt;                         1476.7 203.24
- graze:logarea    1    79.752 1556.4 204.19
+ graze:alt        1     6.075 1470.6 205.01
+ logldist         1     4.777 1471.9 205.06
+ logdist          1     2.067 1474.6 205.16
- yr.isol:logarea  1   177.378 1654.0 207.59
- yr.isol:graze    1   248.142 1724.8 209.94

Step:  AIC=201.95
abund ~ yr.isol + graze + alt + logarea + yr.isol:graze + yr.isol:alt + 
    yr.isol:logarea + graze:logarea

                  Df Sum of Sq    RSS    AIC
- yr.isol:alt      1     18.62 1514.2 200.65
&lt;none&gt;                         1495.6 201.96
+ alt:logarea      1     18.90 1476.7 203.24
+ graze:alt        1     18.26 1477.3 203.27
+ logdist          1      2.03 1493.5 203.88
+ logldist         1      1.79 1493.8 203.89
- yr.isol:graze    1    229.47 1725.0 207.95
- yr.isol:logarea  1    259.20 1754.8 208.91
- graze:logarea    1    330.71 1826.3 211.14

Step:  AIC=200.65
abund ~ yr.isol + graze + alt + logarea + yr.isol:graze + yr.isol:logarea + 
    graze:logarea

                  Df Sum of Sq    RSS    AIC
- alt              1     32.19 1546.4 199.83
&lt;none&gt;                         1514.2 200.65
+ yr.isol:alt      1     18.62 1495.6 201.96
+ alt:logarea      1      8.64 1505.5 202.33
+ logdist          1      3.31 1510.9 202.53
+ graze:alt        1      0.36 1513.8 202.63
+ logldist         1      0.27 1513.9 202.64
- yr.isol:logarea  1    241.21 1755.4 206.93
- yr.isol:graze    1    243.50 1757.7 207.00
- graze:logarea    1    332.95 1847.1 209.78

Step:  AIC=199.83
abund ~ yr.isol + graze + logarea + yr.isol:graze + yr.isol:logarea + 
    graze:logarea

                  Df Sum of Sq    RSS    AIC
&lt;none&gt;                         1546.4 199.83
+ alt              1     32.19 1514.2 200.65
+ logldist         1      6.57 1539.8 201.59
+ logdist          1      0.01 1546.4 201.83
- yr.isol:logarea  1    239.74 1786.1 205.90
- yr.isol:graze    1    272.21 1818.6 206.91
- graze:logarea    1    334.74 1881.1 208.80</code></pre>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 13. Estimate the coefficients of the best-fitting model.</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(z2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = abund ~ yr.isol + graze + logarea + yr.isol:graze + 
    yr.isol:logarea + graze:logarea, data = birds2)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.1445  -2.8572  -0.3756   2.6846  11.6416 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)     1012.42110  344.55122   2.938  0.00502 **
yr.isol           -0.50272    0.17527  -2.868  0.00607 **
graze           -204.03353   67.93366  -3.003  0.00420 **
logarea         -145.27312   53.17222  -2.732  0.00873 **
yr.isol:graze      0.10176    0.03465   2.937  0.00504 **
yr.isol:logarea    0.07438    0.02699   2.756  0.00819 **
graze:logarea      1.22433    0.37593   3.257  0.00205 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.618 on 49 degrees of freedom
Multiple R-squared:  0.756, Adjusted R-squared:  0.7261 
F-statistic:  25.3 on 6 and 49 DF,  p-value: 1.938e-13</code></pre>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 14. AIC comparison</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(z1, z2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   df      AIC
z1  5 371.1092
z2  8 360.7471</code></pre>
</div>
</div>
<p><br><br></p>
</section>
</section>
<section id="harper-adams-data-science" class="level2">
<h2 class="anchored" data-anchor-id="harper-adams-data-science">Harper Adams Data Science</h2>
<p><img src="img/HDS.png" class="img-fluid" alt="Harper Data Science" width="125"></p>
<p>This module is a part of the <a href="https://www.harper-adams.ac.uk/courses/postgraduate/201194/data-science-for-global-agriculture-food-and-environment" title="MSc in Data Science">MSc in Data Science for Global Agriculture, Food, and Environment</a> at <a href="https://www.harper-adams.ac.uk/" title="Harper Adams University">Harper Adams University</a>, led by <a href="https://www.harper-adams.ac.uk/general/staff/profile/201620/Edwin-Harris/" title="Ed's Faculty page">Ed Harris</a>.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>